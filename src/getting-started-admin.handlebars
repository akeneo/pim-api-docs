{{#> layout title="Getting started" active_getting_started=true }}
    <div class="container">
        <div class="row">
            <div class="col-md-offset-2 col-md-8 col-xs-offset-1 col-xs-11">
                <h1>Want to manage the access to the web API?</h1>
                <p><em>These simple steps will guide you and at the end, you will be able to grant access to the API to Peter, your favorite integrator!</em></p>
                <div class="row">
                    <div class="col-xs-12">
                        <div class="panel panel-picto panel-default panel-getting-started">
                            <img src="img/illustrations/illus--lock.svg"/>
                            <div class="panel-body">
                                <h2 class="picto">Prerequisites</h2>
                                <h4><i class="fa fa-check-square"></i> An Akeneo PIM is already installed</h4>
                                <p>This can seems pretty obvious. But yeah ! You will need a PIM already installed if you want to manage any access to this PIM.</p><br>
                                <h4><i class="fa fa-check-square"></i> You are the administrator of the Akeneo PIM</h4>
                                <p>You will need to have the rights to administrate the roles and users inside the PIM, so if you are the PIM administrator, it should be ok.</p><br>
                                <h4><i class="fa fa-check-square"></i> Peter, your favorite connector developer, is declared as a user in Akeneo PIM</h4>
                                <p>Peter wants to develop a new connector for your Akeneo PIM and this conector will be doing requests via the Web API.</p>
                                <p>If not already done, create a new user named <code>Peter</code> in Akeneo PIM.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-1">
                        <p class="panel-number">1</p>
                    </div>
                    <div class="col-xs-11">
                        <div class="panel panel-default panel-getting-started">
                            <div class="panel-body">
                                <h2 class="picto">Create a Web API dedicated role</h2>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <p>Log in as administrator in your PIM. In the <code>System</code> menu, select the <code>User management</code> menu, then click on the <code>Role</code> entry. From here, you should be able to create a role, click on <code>Create role</code>.</p>
                                        <div>
                                            <ul class="nav nav-tabs nav-tabs-versions" role="tablist">
                                                <li role="presentation" class="active">
                                                    <a href="#v2_create_a_role" aria-controls="v2_create_a_role" role="tab" data-toggle="tab">v2.0</a>
                                                </li>
                                                <li role="presentation">
                                                    <a href="#v17_create_a_role" aria-controls="v17_create_a_role" role="tab" data-toggle="tab">v1.7</a>
                                                </li>
                                            </ul>
                                            <div class="panel panel-default">
                                                <div class="panel-body">
                                                    <div class="row tab-content">
                                                        <div role="tabpanel" class="col-xs-12 tab-pane active" id="v2_create_a_role">
                                                            <p><img class="img-responsive" alt="Activate API access" src="/img/screenshots/v2.0/create_a_role.png"></p>
                                                        </div>
                                                        <div role="tabpanel" class="col-xs-12 tab-pane" id="v17_create_a_role">
                                                            <p><img class="img-responsive" alt="Activate API access" src="/img/screenshots/v1.7/create_a_role.png"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <p>Once in the role form, give a name to the role you are creating, <code>Whole API access</code> for instance.</p>
                                        <p>Then go to the <code>Web API Permissions</code> tab and activate the access to the Web API by clicking on <code>Overall Web API access</code>.</p>
                                        <div>
                                            <ul class="nav nav-tabs nav-tabs-versions" role="tablist">
                                                <li role="presentation" class="active">
                                                    <a href="#v2_activate_api_access" aria-controls="v2_activate_api_access" role="tab" data-toggle="tab">v2.0</a>
                                                </li>
                                                <li role="presentation">
                                                    <a href="#v17_activate_api_access" aria-controls="v17_activate_api_access" role="tab" data-toggle="tab">v1.7</a>
                                                </li>
                                            </ul>
                                            <div class="panel panel-default">
                                                <div class="panel-body">
                                                    <div class="row tab-content">
                                                        <div role="tabpanel" class="col-xs-12 tab-pane active" id="v2_activate_api_access">
                                                            <p><img class="img-responsive" alt="Activate API access" src="/img/screenshots/v2.0/activate_api_access.png"></p>
                                                        </div>
                                                        <div role="tabpanel" class="col-xs-12 tab-pane" id="v17_activate_api_access">
                                                            <p><img class="img-responsive" alt="Activate API access" src="/img/screenshots/v1.7/activate_api_access.png"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <p>To finish, save your role by clicking on the <code>Save</code> button.</p>
                                        <p>Great! You now have a role ready to access to the Web API. Let's go to the next step!</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-1">
                        <p class="panel-number">2</p>
                    </div>
                    <div class="col-xs-11">
                        <div class="panel panel-default panel-getting-started">
                            <div class="panel-body">
                                <h2 class="picto">Give to Peter the role that allows him to access to the Web API</h2>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <p>So now you have your role dedicated to the access of the Web API, you can give this role to a set of users. In the form of this role, got to the <code>Users</code> tab, select the users for which you want to give the access. Below, for example, we give to our developer <code>Peter</code> the <code>Whole API access</code> role.</p>
                                        <div>
                                            <ul class="nav nav-tabs nav-tabs-versions" role="tablist">
                                                <li role="presentation" class="active">
                                                    <a href="#v2_locales" aria-controls="v2_locales" role="tab" data-toggle="tab">v2.0</a>
                                                </li>
                                                <li role="presentation">
                                                    <a href="#v17_locales" aria-controls="v17_locales" role="tab" data-toggle="tab">v1.7</a>
                                                </li>
                                            </ul>
                                            <div class="panel panel-default">
                                                <div class="panel-body">
                                                    <div class="row tab-content">
                                                        <div role="tabpanel" class="col-xs-12 tab-pane active" id="v2_locales">
                                                            <p><img class="img-responsive" alt="Peter get the access" src="/img/screenshots/v2.0/peter_get_the_access.png"></p>
                                                        </div>
                                                        <div role="tabpanel" class="col-xs-12 tab-pane" id="v17_locales">
                                                            <p><img class="img-responsive" alt="Peter get the access" src="/img/screenshots/v1.7/peter_get_the_access.png"></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-1">
                        <p class="panel-number">3</p>
                    </div>
                    <div class="col-xs-11">
                        <div class="panel panel-default panel-getting-started">
                            <div class="panel-body">
                                <h2 class="picto">Generate an OAuth client id and secret</h2>
                                <div class="row">
                                    <div class="col-xs-12">
                                        <p>Having a user with a role giving access to the Web API is not enough to make requests via the Web API. Peter will ask you for OAuth client id and secret so as he can be authenticated.</p>
                                        <p>There are 2 ways to generate client ids and secrets.</p>
                                        <h3>With the PIM UI</h3>
                                        <p>Go to the <code>System</code> menu of your PIM and select the <code>API connections</code> entry.</p> From here, you can click on the <code>Create</code> button. Give a name to the connection you are about to create and confirrm. The PIM will then automatically create credentials for you, that you will find in the API connections grid.</p>
                                        <img class="img-responsive" src="/img/screenshots/v2.0/authentication_ui.png"></img>
                                        <div class="alert alert-warning">
                                            This feature is only available in the PIM 2.0. If you are trying to use the API on a 1.7 PIM, please have a look to the second method below.
                                        </div>
                                        <h3>With a command line</h3>
                                        <p>Alternatively, you can create the client id and secret with a single command line directly on the PIM server.</p>
                                        <h4>With the 2.0 version</h4>
<pre class="hljs"><code>php bin/console pim:oauth-server:create-client my-customer-account \
    --grant_type=<span class="hljs-string">"password"</span> \
    --grant_type=<span class="hljs-string">"refresh_token"</span> \
    --env=prod</code>
                                        </pre>
                                        <h4>With the 1.7 version</h4>
                                        <pre class="hljs"><code>php app/console pim:oauth-server:create-client \
    --label=<span class="hljs-string">"my-customer-account"</span>
    --grant_type=<span class="hljs-string">"password"</span> \
    --grant_type=<span class="hljs-string">"refresh_token"</span> \
    --env=prod</code>
                                        </pre>
                                        <p>You will get something like:</p>
                                        <pre class="hljs"><code>A new client has been added:
client_id: 4gm4rnoizp8gskgkk080ssoo80040g44ksowwgw844k44sc00s
secret: 5dyvo1z6y34so4ogkgksw88ookoows00cgoc488kcs8wk4c40s
label: my-customer-account</code>
                                        </pre>
                                        <p>Give by any mean of your choice these credentials to Peter. And that's it! Thanks to it, he will be able to finally access the API. Take a look to the <a href="getting-started.html">Developer Getting started</a> to know how.</p>
                                        <div class="alert alert-info">To revoke the access, you just have to revoke it from the <code>API connections</code> screen (in 2.0) or run a single command line (in 1.7). To have more details, take a look at the <a href="/documentation/security.html">Security</a> section of the documention.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-xs-12">
                        <p class="lead text-center">That's it! Peter is now ready to build amazing tools for your Akeneo PIM!</p>
                        <p class="text-center"><em>If you want to know more about managing the access to the web API, don't hesitate to</em></p>
                        <div class="row">
                            <div class="col-xs-offset-3 col-xs-6">
                                <a class="btn btn-info btn-block" href="/documentation/security.html#security">Browse our Security doc</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <hr>
        {{> contrib-footer}}
    </div>
{{/layout}}
